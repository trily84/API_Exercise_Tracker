((r)=>{
   shorten=r('./index.js');
   http=r('http');
    /**
    *  Generate Shorten ID [Async]
    */
   shorten('http://abdennoor.com',function(id){
            console.log(id);
   });

   /**
   *  Generate Shorten ID [Sync]
   */
    let sid=shorten('http://google.com');
    console.log(sid);
    /**
    *  Set Suggested Shorten ID [Async]
    */
    shorten('http://abdennoor.com','abdo',function(available){
          if(!available){
              //second attempt

          }
    });

    /**
    *  Set Suggested Shorten ID [Sync]
    */
     var isAvailable=shorten('http://abdennoor.com','abdennoor-cv');
    /*===============*/

    /*
    * Find URL by Shorten ID [Async]
    */
    shorten('er3Rfq',function(url){
      if(url){
         //do what u need with this URL : Typecally , it is a redirect.
      }
    })

    /*
    * Find URL by Shorten ID [Sync]
    */

    var url=shorten('er3Rfq');
    if(url){
      //do your staff
    }

    /**
    *   Use inside http server
    */

    http.createServer((req,res)=>{
      let url=shorten(req.url.slice(1)); // slice to remove slash  : "/er3Rfq" --> "er3Rfq"
      res.writeHead(301,{Location: url});
      res.end();
    }).listen(3000);

    /**
    * Use inside express server
    */
    shorten.all().forEach((sid)=>{
        app.get(`/${sid}`,(req,res)=>{
              let url=shorten(sid);
              res.redirect(url);
        })
    })
})(require)
